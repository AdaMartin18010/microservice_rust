# 14.4 边缘计算高吞吐参考架构

- 框架：Actix-Web（高并发）/ axum（生态一致）
- 协议：HTTP/1.1 + HTTP/2；数据面尽量使用二进制（bincode/rmp）
- 缓冲：Bytes 零拷贝；mio/epoll 优化；批处理写入
- 消息：NATS（低延迟）或 Kafka（吞吐优先）
- 存储：本地 LRU + Redis；时间序列上报 Prometheus remote write
- 观测：采样率上移边缘；汇聚后集中存储；断点续传

## 关键落地点

- Rust 1.90：调度与背压；spawn_blocking 隔离 CPU 密集任务
- 网络调优：tcp_nodelay/keepalive/连接池上限；预热与亲和性
- 失败策略：断网缓冲与回放；幂等投递；本地降级

## 最小可行组合（MVP）

Actix-Web + NATS + Redis + OTel + Traefik + Kubernetes

## 最小配置模板（片段）

```yaml
# docker-compose.nats.yml（片段）
version: '3.8'
services:
  nats:
    image: nats:2.10
    command: ["-js"]
    ports:
      - "4222:4222"
      - "8222:8222"
```

- Rust 侧：使用 `nats` 或 `async-nats` 客户端；开启 `tcp_nodelay` 与连接池上限，结合 Bytes 零拷贝。
