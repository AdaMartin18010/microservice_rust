# ä¾èµ–ç®¡ç†ä¸ç‰ˆæœ¬å‡çº§ç­–ç•¥

> åŸºäºRust 1.90å’Œ2025å¹´æœ€æ–°æŠ€æœ¯æ ˆçš„ä¾èµ–ç®¡ç†æœ€ä½³å®è·µ

## ğŸ“‹ æ¦‚è¿°

æœ¬æ–‡æ¡£è¯¦ç»†ä»‹ç»äº†Rustå¾®æœåŠ¡é¡¹ç›®ä¸­ä¾èµ–ç®¡ç†çš„ç­–ç•¥ã€ç‰ˆæœ¬å‡çº§çš„æœ€ä½³å®è·µï¼Œä»¥åŠå¦‚ä½•ç¡®ä¿ç³»ç»Ÿæ—¶é—´åŒæ­¥å’Œä¾èµ–ç‰ˆæœ¬å¯¹é½ã€‚

## ğŸ¯ æ ¸å¿ƒåŸåˆ™

### 1. ç‰ˆæœ¬ç®¡ç†åŸåˆ™

- **è¯­ä¹‰åŒ–ç‰ˆæœ¬æ§åˆ¶**ï¼šéµå¾ªSemVerè§„èŒƒ
- **å®‰å…¨ä¼˜å…ˆ**ï¼šåŠæ—¶ä¿®å¤å®‰å…¨æ¼æ´
- **å…¼å®¹æ€§ä¿è¯**ï¼šç¡®ä¿APIå…¼å®¹æ€§
- **æ€§èƒ½ä¼˜åŒ–**ï¼šåˆ©ç”¨æœ€æ–°æ€§èƒ½æ”¹è¿›

### 2. å‡çº§ç­–ç•¥

- **æ¸è¿›å¼å‡çº§**ï¼šåˆ†é˜¶æ®µå‡çº§ï¼Œé™ä½é£é™©
- **è‡ªåŠ¨åŒ–æ£€æŸ¥**ï¼šä½¿ç”¨å·¥å…·è‡ªåŠ¨æ£€æŸ¥è¿‡æ—¶ä¾èµ–
- **å›æ»šæœºåˆ¶**ï¼šä¿æŒå¿«é€Ÿå›æ»šèƒ½åŠ›
- **æµ‹è¯•è¦†ç›–**ï¼šç¡®ä¿å‡çº§ååŠŸèƒ½æ­£å¸¸

## ğŸ”§ å·¥å…·ä¸å‘½ä»¤

### 1. ä¾èµ–æ£€æŸ¥å·¥å…·

```bash
# æ£€æŸ¥è¿‡æ—¶ä¾èµ–
cargo outdated

# æ£€æŸ¥å®‰å…¨æ¼æ´
cargo audit

# æ£€æŸ¥ä¾èµ–æ ‘
cargo tree

# æ›´æ–°ä¾èµ–
cargo update
```

### 2. ç‰ˆæœ¬ç®¡ç†è„šæœ¬

```bash
#!/bin/bash
# scripts/dependency_upgrade.sh

echo "ğŸ” æ£€æŸ¥ä¾èµ–çŠ¶æ€..."

# 1. æ£€æŸ¥è¿‡æ—¶ä¾èµ–
echo "æ£€æŸ¥è¿‡æ—¶ä¾èµ–..."
cargo outdated

# 2. æ£€æŸ¥å®‰å…¨æ¼æ´
echo "æ£€æŸ¥å®‰å…¨æ¼æ´..."
cargo audit

# 3. æ›´æ–°ä¾èµ–
echo "æ›´æ–°ä¾èµ–..."
cargo update

# 4. éªŒè¯æ„å»º
echo "éªŒè¯æ„å»º..."
cargo check
cargo build

# 5. è¿è¡Œæµ‹è¯•
echo "è¿è¡Œæµ‹è¯•..."
cargo test

echo "âœ… ä¾èµ–å‡çº§å®Œæˆ"
```

## ğŸ“Š æœ€æ–°ä¾èµ–ç‰ˆæœ¬ï¼ˆ2025å¹´1æœˆï¼‰

### 1. æ ¸å¿ƒæ¡†æ¶

| ä¾èµ– | å½“å‰ç‰ˆæœ¬ | æœ€æ–°ç‰ˆæœ¬ | çŠ¶æ€ | å‡çº§å»ºè®® |
|------|----------|----------|------|----------|
| axum | 0.8.5 | 0.8.5 | âœ… æœ€æ–° | ä¿æŒ |
| actix-web | 4.11.0 | 4.11.0 | âœ… æœ€æ–° | ä¿æŒ |
| poem | 3.1 | 3.1 | âœ… æœ€æ–° | é‡å¤§æ›´æ–°å®Œæˆ |
| volo | 0.11 | 0.11 | âœ… æœ€æ–° | åŠŸèƒ½å¢å¼ºå®Œæˆ |

### 2. æ•°æ®å­˜å‚¨

| ä¾èµ– | å½“å‰ç‰ˆæœ¬ | æœ€æ–°ç‰ˆæœ¬ | çŠ¶æ€ | å‡çº§å»ºè®® |
|------|----------|----------|------|----------|
| sqlx | 0.8.7 | 0.8.7 | âœ… æœ€æ–° | å®‰å…¨ä¿®å¤å®Œæˆ |
| diesel | 2.3.2 | 2.3.2 | âœ… æœ€æ–° | ä¿æŒ |
| redis | 0.32.6 | 0.32.6 | âœ… æœ€æ–° | æ€§èƒ½ä¼˜åŒ–å®Œæˆ |

### 3. æ¶ˆæ¯é˜Ÿåˆ—

| ä¾èµ– | å½“å‰ç‰ˆæœ¬ | æœ€æ–°ç‰ˆæœ¬ | çŠ¶æ€ | å‡çº§å»ºè®® |
|------|----------|----------|------|----------|
| lapin | 3.7 | 3.7 | âœ… æœ€æ–° | é‡å¤§æ›´æ–°å®Œæˆ |
| kafka | 0.10.0 | 0.10.0 | âœ… æœ€æ–° | ä¿æŒ |

### 4. AI/MLåº“

| ä¾èµ– | å½“å‰ç‰ˆæœ¬ | æœ€æ–°ç‰ˆæœ¬ | çŠ¶æ€ | å‡çº§å»ºè®® |
|------|----------|----------|------|----------|
| candle-core | 0.9 | 0.9 | âœ… æœ€æ–° | é‡å¤§æ›´æ–°å®Œæˆ |
| tch | 0.20 | 0.20 | âœ… æœ€æ–° | æ€§èƒ½æå‡å®Œæˆ |
| tokenizers | 0.22 | 0.22 | âœ… æœ€æ–° | åŠŸèƒ½å¢å¼ºå®Œæˆ |

## ğŸ› ï¸ å‡çº§å®æ–½æ­¥éª¤

### 1. å‡†å¤‡å·¥ä½œ

```bash
# 1. å¤‡ä»½å½“å‰çŠ¶æ€
git add .
git commit -m "å¤‡ä»½ï¼šå‡çº§å‰çŠ¶æ€"

# 2. åˆ›å»ºå‡çº§åˆ†æ”¯
git checkout -b dependency-upgrade-2025-01

# 3. æ£€æŸ¥å½“å‰ä¾èµ–çŠ¶æ€
cargo outdated > outdated_deps.txt
cargo audit > security_audit.txt
```

### 2. åˆ†é˜¶æ®µå‡çº§

#### é˜¶æ®µ1ï¼šå®‰å…¨ä¿®å¤

```bash
# ä¼˜å…ˆä¿®å¤å®‰å…¨æ¼æ´
cargo audit --fix

# éªŒè¯ä¿®å¤
cargo check
cargo test
```

#### é˜¶æ®µ2ï¼šè¡¥ä¸ç‰ˆæœ¬å‡çº§

```bash
# å‡çº§è¡¥ä¸ç‰ˆæœ¬ï¼ˆå‘åå…¼å®¹ï¼‰
cargo update --patch

# éªŒè¯å…¼å®¹æ€§
cargo check
cargo test
```

#### é˜¶æ®µ3ï¼šæ¬¡è¦ç‰ˆæœ¬å‡çº§

```bash
# å‡çº§æ¬¡è¦ç‰ˆæœ¬ï¼ˆæ–°åŠŸèƒ½ï¼‰
cargo update --minor

# å…¨é¢æµ‹è¯•
cargo test --all-features
cargo clippy --all-targets
```

#### é˜¶æ®µ4ï¼šä¸»è¦ç‰ˆæœ¬å‡çº§

```bash
# ä¸»è¦ç‰ˆæœ¬å‡çº§ï¼ˆå¯èƒ½ç ´åå…¼å®¹æ€§ï¼‰
# éœ€è¦æ‰‹åŠ¨ä¿®æ”¹Cargo.toml
# ç„¶åè¿è¡Œï¼š
cargo update
cargo check
cargo test
```

### 3. éªŒè¯ä¸æµ‹è¯•

```bash
# 1. ç¼–è¯‘æ£€æŸ¥
cargo check --all-targets --all-features

# 2. ä»£ç è´¨é‡æ£€æŸ¥
cargo clippy --all-targets --all-features -- -D warnings

# 3. æ ¼å¼åŒ–æ£€æŸ¥
cargo fmt --all -- --check

# 4. è¿è¡Œæµ‹è¯•å¥—ä»¶
cargo test --all-features

# 5. æ€§èƒ½åŸºå‡†æµ‹è¯•
cargo bench

# 6. å®‰å…¨æ£€æŸ¥
cargo audit
```

## â° ç³»ç»Ÿæ—¶é—´åŒæ­¥

### 1. Windowsç³»ç»Ÿ

```powershell
# æ£€æŸ¥æ—¶é—´åŒæ­¥çŠ¶æ€
w32tm /query /status

# å¼ºåˆ¶åŒæ­¥æ—¶é—´ï¼ˆéœ€è¦ç®¡ç†å‘˜æƒé™ï¼‰
w32tm /resync

# é…ç½®æ—¶é—´æœåŠ¡å™¨
w32tm /config /manualpeerlist:"time.windows.com,0x9" /syncfromflags:manual
```

### 2. Linuxç³»ç»Ÿ

```bash
# æ£€æŸ¥æ—¶é—´åŒæ­¥çŠ¶æ€
timedatectl status

# å¯ç”¨NTPåŒæ­¥
sudo timedatectl set-ntp true

# æ‰‹åŠ¨åŒæ­¥æ—¶é—´
sudo ntpdate -s time.nist.gov
```

### 3. macOSç³»ç»Ÿ

```bash
# æ£€æŸ¥æ—¶é—´åŒæ­¥çŠ¶æ€
sntp -qS time.apple.com

# å¯ç”¨è‡ªåŠ¨æ—¶é—´åŒæ­¥
sudo systemsetup -setusingnetworktime on

# æ‰‹åŠ¨åŒæ­¥æ—¶é—´
sudo sntp -sS time.apple.com
```

## ğŸ” å¸¸è§é—®é¢˜ä¸è§£å†³æ–¹æ¡ˆ

### 1. ç‰ˆæœ¬å†²çª

**é—®é¢˜**ï¼šä¾èµ–ç‰ˆæœ¬å†²çªå¯¼è‡´ç¼–è¯‘å¤±è´¥

**è§£å†³æ–¹æ¡ˆ**ï¼š

```toml
# åœ¨Cargo.tomlä¸­ä½¿ç”¨[patch.crates-io]è§£å†³å†²çª
[patch.crates-io]
conflicting-crate = "1.0.0"
```

### 2. ç‰¹æ€§æ ‡å¿—ä¸å…¼å®¹

**é—®é¢˜**ï¼šæ–°ç‰ˆæœ¬ç§»é™¤äº†æŸäº›ç‰¹æ€§æ ‡å¿—

**è§£å†³æ–¹æ¡ˆ**ï¼š

```toml
# æ›´æ–°ç‰¹æ€§æ ‡å¿—
[dependencies]
some-crate = { version = "2.0", features = ["new-feature"] }
```

### 3. APIå˜æ›´

**é—®é¢˜**ï¼šæ–°ç‰ˆæœ¬APIå‘ç”Ÿç ´åæ€§å˜æ›´

**è§£å†³æ–¹æ¡ˆ**ï¼š

```rust
// ä½¿ç”¨æ¡ä»¶ç¼–è¯‘å¤„ç†APIå˜æ›´
#[cfg(feature = "new-api")]
use new_crate::NewApi;

#[cfg(not(feature = "new-api"))]
use old_crate::OldApi;
```

## ğŸ“ˆ æ€§èƒ½ä¼˜åŒ–å»ºè®®

### 1. ä¾èµ–ä¼˜åŒ–

```toml
# ä½¿ç”¨workspaceä¾èµ–ç»Ÿä¸€ç‰ˆæœ¬ç®¡ç†
[workspace.dependencies]
tokio = { version = "1.47.1", features = ["full"] }
serde = { version = "1.0.228", features = ["derive"] }
```

### 2. ç‰¹æ€§æ ‡å¿—ä¼˜åŒ–

```toml
# åªå¯ç”¨éœ€è¦çš„ç‰¹æ€§
[dependencies]
reqwest = { version = "0.12.23", features = ["json", "rustls-tls"] }
```

### 3. æ„å»ºä¼˜åŒ–

```toml
# ä¼˜åŒ–æ„å»ºé…ç½®
[profile.release]
opt-level = 3
lto = "fat"
codegen-units = 1
strip = "symbols"
panic = "abort"
```

## ğŸš€ è‡ªåŠ¨åŒ–å‡çº§æµç¨‹

### 1. CI/CDé›†æˆ

```yaml
# .github/workflows/dependency-update.yml
name: Dependency Update

on:
  schedule:
    - cron: '0 0 * * 1'  # æ¯å‘¨ä¸€æ£€æŸ¥
  workflow_dispatch:

jobs:
  update-deps:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      - uses: actions-rs/toolchain@v1
        with:
          toolchain: stable
      
      - name: Check outdated dependencies
        run: cargo outdated
      
      - name: Check security vulnerabilities
        run: cargo audit
      
      - name: Update dependencies
        run: cargo update
      
      - name: Run tests
        run: cargo test --all-features
      
      - name: Create PR
        if: success()
        run: |
          git config --local user.email "action@github.com"
          git config --local user.name "GitHub Action"
          git add Cargo.lock
          git commit -m "Update dependencies"
          git push
```

### 2. è‡ªåŠ¨åŒ–è„šæœ¬

```bash
#!/bin/bash
# scripts/auto_dependency_upgrade.sh

set -e

echo "ğŸš€ å¼€å§‹è‡ªåŠ¨åŒ–ä¾èµ–å‡çº§..."

# 1. æ£€æŸ¥è¿‡æ—¶ä¾èµ–
echo "æ£€æŸ¥è¿‡æ—¶ä¾èµ–..."
OUTDATED=$(cargo outdated --format json | jq -r '.[] | select(.latest != .installed) | .name')

if [ -z "$OUTDATED" ]; then
    echo "âœ… æ‰€æœ‰ä¾èµ–éƒ½æ˜¯æœ€æ–°ç‰ˆæœ¬"
    exit 0
fi

echo "å‘ç°è¿‡æ—¶ä¾èµ–: $OUTDATED"

# 2. æ£€æŸ¥å®‰å…¨æ¼æ´
echo "æ£€æŸ¥å®‰å…¨æ¼æ´..."
if ! cargo audit; then
    echo "âŒ å‘ç°å®‰å…¨æ¼æ´ï¼Œè¯·å…ˆä¿®å¤"
    exit 1
fi

# 3. æ›´æ–°ä¾èµ–
echo "æ›´æ–°ä¾èµ–..."
cargo update

# 4. éªŒè¯æ„å»º
echo "éªŒè¯æ„å»º..."
cargo check --all-targets --all-features

# 5. è¿è¡Œæµ‹è¯•
echo "è¿è¡Œæµ‹è¯•..."
cargo test --all-features

# 6. ä»£ç è´¨é‡æ£€æŸ¥
echo "ä»£ç è´¨é‡æ£€æŸ¥..."
cargo clippy --all-targets --all-features -- -D warnings

echo "âœ… ä¾èµ–å‡çº§å®Œæˆ"
```

## âœ… 2025å¹´9æœˆå‡çº§å®Œæˆæ€»ç»“

### å‡çº§æˆæœ

æœ¬æ¬¡ä¾èµ–å‡çº§å·²æˆåŠŸå®Œæˆï¼Œä¸»è¦æˆæœåŒ…æ‹¬ï¼š

#### 1. æ ¸å¿ƒæ¡†æ¶å‡çº§

- **Poem**: 2.0 â†’ 3.1 (é‡å¤§ç‰ˆæœ¬æ›´æ–°ï¼Œæ€§èƒ½æå‡)
- **Volo**: 0.8 â†’ 0.11 (åŠŸèƒ½å¢å¼ºï¼ŒAPIä¼˜åŒ–)
- **Axum**: 0.8.4 â†’ 0.8.5 (æ€§èƒ½ä¼˜åŒ–)
- **thiserror**: 2.0.16 â†’ 2.0.17 (é”™è¯¯å¤„ç†å¢å¼º)
- **serde**: 1.0.227 â†’ 1.0.228 (åºåˆ—åŒ–ä¼˜åŒ–)
- **quote**: 1.0.40 â†’ 1.0.41 (å®å¤„ç†ä¼˜åŒ–)

#### 2. æ•°æ®å­˜å‚¨ä¼˜åŒ–

- **Redis**: 0.32.5 â†’ 0.32.6 (æ€§èƒ½ä¼˜åŒ–)
- **SQLx**: 0.8 â†’ 0.8.7 (å®‰å…¨ä¿®å¤)

#### 3. æ¶ˆæ¯é˜Ÿåˆ—å‡çº§

- **Lapin**: 2.5.4 â†’ 3.7 (é‡å¤§ç‰ˆæœ¬æ›´æ–°ï¼ŒAPIé‡æ„)

#### 4. AI/MLåº“ç°ä»£åŒ–

- **Candle**: 0.2 â†’ 0.9 (é‡å¤§æ›´æ–°ï¼ŒåŠŸèƒ½å¢å¼º)
- **Tch**: 0.13 â†’ 0.20 (æ€§èƒ½æå‡)
- **Tokenizers**: 0.15 â†’ 0.22 (åŠŸèƒ½å¢å¼º)

#### 5. äº‘åŸç”Ÿå·¥å…·å‡çº§

- **Kubernetes**: 0.88 â†’ 2.0 (é‡å¤§ç‰ˆæœ¬æ›´æ–°)
- **k8s-openapi**: 0.21.1 â†’ 0.26.0 (APIæ›´æ–°ï¼Œç‰¹æ€§ä¿®å¤)

#### 6. ç½‘ç»œä¸HTTPä¼˜åŒ–

- **h2**: 0.3 â†’ 0.4 (HTTP/2åè®®ä¼˜åŒ–)
- **tokio-rustls**: 0.26.3 â†’ 0.26.4 (TLSæ€§èƒ½æå‡)

### éªŒè¯ç»“æœ

- âœ… **ç¼–è¯‘æ£€æŸ¥**: `cargo check` é€šè¿‡
- âœ… **æ„å»ºæµ‹è¯•**: `cargo build` æˆåŠŸ
- âœ… **å…¼å®¹æ€§**: æ‰€æœ‰ä¾èµ–ç‰ˆæœ¬å¯¹é½ï¼Œæ— å†²çª
- âœ… **å®‰å…¨æ€§**: ä¿®å¤å·²çŸ¥å®‰å…¨æ¼æ´
- âœ… **æ€§èƒ½**: åˆ©ç”¨æœ€æ–°æ€§èƒ½ä¼˜åŒ–

### ç³»ç»Ÿæ—¶é—´åŒæ­¥çŠ¶æ€

- **å½“å‰æ—¶é—´**: 2025å¹´9æœˆ27æ—¥ 8:15:37
- **åŒæ­¥çŠ¶æ€**: éœ€è¦ç®¡ç†å‘˜æƒé™åŒæ­¥
- **å»ºè®®**: ä»¥ç®¡ç†å‘˜èº«ä»½è¿è¡Œ `w32tm /resync`

## ğŸ“š æœ€ä½³å®è·µæ€»ç»“

### 1. å‡çº§å‰å‡†å¤‡

- âœ… å¤‡ä»½å½“å‰çŠ¶æ€
- âœ… åˆ›å»ºå‡çº§åˆ†æ”¯
- âœ… æ£€æŸ¥å®‰å…¨æ¼æ´
- âœ… äº†è§£å˜æ›´å†…å®¹

### 2. å‡çº§è¿‡ç¨‹

- âœ… åˆ†é˜¶æ®µå‡çº§
- âœ… åŠæ—¶éªŒè¯
- âœ… ä¿æŒæµ‹è¯•è¦†ç›–
- âœ… è®°å½•å˜æ›´æ—¥å¿—

### 3. å‡çº§åéªŒè¯

- âœ… ç¼–è¯‘æ£€æŸ¥
- âœ… åŠŸèƒ½æµ‹è¯•
- âœ… æ€§èƒ½æµ‹è¯•
- âœ… å®‰å…¨æ£€æŸ¥

### 4. æŒç»­ç»´æŠ¤

- âœ… å®šæœŸæ£€æŸ¥æ›´æ–°
- âœ… è‡ªåŠ¨åŒ–å‡çº§æµç¨‹
- âœ… ç›‘æ§å®‰å…¨æ¼æ´
- âœ… ä¿æŒæ–‡æ¡£æ›´æ–°

## ğŸ”— ç›¸å…³èµ„æº

- [Cargo Book - Dependencies](https://doc.rust-lang.org/cargo/reference/dependencies.html)
- [Rust Security Advisory Database](https://rustsec.org/)
- [cargo-outdated](https://github.com/kbknapp/cargo-outdated)
- [cargo-audit](https://github.com/RustSec/cargo-audit)
- [Semantic Versioning](https://semver.org/)

---

**æ³¨æ„**ï¼šæœ¬æ–‡æ¡£åŸºäº2025å¹´1æœˆçš„æœ€æ–°ä¾èµ–ç‰ˆæœ¬ï¼Œå»ºè®®å®šæœŸæ›´æ–°ä»¥ä¿æŒæ—¶æ•ˆæ€§ã€‚
