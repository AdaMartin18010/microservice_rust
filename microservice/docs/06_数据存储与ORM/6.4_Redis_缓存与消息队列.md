# 6.4 Redis 缓存与消息队列

Redis 在微服务中常用于缓存、速率限制、分布式锁、Pub/Sub 与队列。

## 6.4.1 集成

- 使用 `redis`/`bb8-redis` 实现异步连接池；
- Key 规范：前缀/版本/TTL；
- 热点数据采用二级缓存（本地 LRU + Redis）。

## 6.4.2 队列与流

- 简单队列：List + BRPOP；
- 流：Redis Streams（消费组、断点续传）。

## 6.4.3 限流与分布式锁

- 令牌桶/Lua 脚本原子性；
- Redlock 谨慎使用，优先单实例强一致方案或 etcd 锁。
