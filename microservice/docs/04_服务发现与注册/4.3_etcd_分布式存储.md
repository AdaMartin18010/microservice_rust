# 4.3 etcd 分布式存储

## 📋 目录

- [4.3 etcd 分布式存储](#43-etcd-分布式存储)
  - [📋 目录](#-目录)
  - [4.3.1 服务注册模型](#431-服务注册模型)
  - [4.3.2 Rust 客户端](#432-rust-客户端)
  - [4.3.3 生产建议](#433-生产建议)

etcd 提供高可用的键值存储，常用作服务注册、配置、分布式锁与选主。

## 4.3.1 服务注册模型

- 使用租约（lease）+ 临时 key 表示实例；
- 客户端维持心跳续租，断连自动过期删除；
- Watch 订阅前缀变化，动态更新本地路由。

## 4.3.2 Rust 客户端

- 推荐官方或社区 `etcd-client`；
- 异步 API + 流式 Watch；
- 结合 `tokio` 执行心跳/重连退避策略。

## 4.3.3 生产建议

- 使用多节点集群与正确的选主配置；
- 合理的 key 设计（前缀/命名空间/实例标签）；
- 配额与压缩策略，防止历史版本堆积。
